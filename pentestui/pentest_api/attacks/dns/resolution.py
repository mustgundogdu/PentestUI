"""
    DNS RESOLUTION
"""
from scapy.all import IP, sr1, ICMP

class DNSResolution:
    def ResolArguments(self, serverIP):

        self.serverIP = serverIP
        if self.serverIP:
            self.GETIPREsolution(self.serverIP)


    def GETIPREsolution(self, serverIP):


        Server = IP(dst=serverIP)/ICMP()
        answerFromServer = sr1(Server, verbose=0, timeout=2)

        if answerFromServer:
            self.socketstatuts = 'Open'

        else:
            self.socketstatuts = 'Close'
