"""
LDAP CONNECTION
"""

from ldap3 import Server, Connection, ALL, Tls, EXTERNAL, SASL, DIGEST_MD5
import os, sys
from .status import ConnectionStatus
"""
In this Part, SIMPLE LDAP Bind WITH Ldap3 Module
"""


class SimpleBind(ConnectionStatus):
    """Connection Arguments For Spn User Enum """
    def ReceivedArguments(self, ldapusername, ldapassword, serverIP, domainName):
        """Connection to Server"""
        simpleServer = Server(serverIP, get_info='ALL')
        simpleConn = Connection(simpleServer, user=ldapusername, password=ldapassword)
        if not simpleConn.bind():
            status = 'No Bind'
            self.SimpleBindStatus(status)
        else:
            status = 'Connection Ok'
            self.SimpleBindStatus(status)
            self.SimpleConnection = simpleConn

class passwordSprayAttack:
    """ Password Spray Attack Part"""
    def ReceivedSprayArguments(self, serverIP, username, sprayPassword):
        """Recursive Ldap Simple Connection"""
        simpleServer = Server(serverIP, get_info='ALL')
        self.simpleConnspray = Connection(simpleServer, user=username, password=sprayPassword)
